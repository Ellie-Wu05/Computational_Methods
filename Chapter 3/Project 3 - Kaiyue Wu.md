# Project 3 - Kaiyue Wu

## 1. Evaluate the following expected values and probabilities:

Inputs: $X_0,Y_0$

Outputs: 

1. **P(Y2 > 5) = 0.97800**
2. **e1 = 0.645733**
3. **e2 = 26.30914**
4. **e3 = 3.893022**

<img src="/Users/elliewu/Library/Application Support/typora-user-images/image-20220420234548955.png" alt="image-20220420234548955" style="zoom:50%;" />

## 2. Estimate the following expected values:

Inputs: $X_0$

Outputs:

1. **e1 = 0.978**
2. **e2 = 0.645733**

<img src="/Users/elliewu/Library/Application Support/typora-user-images/image-20220420234741371.png" alt="image-20220420234741371" style="zoom:50%;" />

## 3. 

### a. European Call options via Monte Carlo simulation

With dt = 0.004 and Antithetic Variates and Euler Method

```python
MC_EuroCall(s0=15,k=20,sigma=0.25,r=0.04,t=0.5)
The Monte Carlo price is: 0.08025144505413202
```

### b. European Call options by using the Black-Scholes formula

The Black-Scholes price is: **0.08575224964083072**

```python
BS_EuroCall(s0=15,k=20,sigma=0.25,r=0.04,t=0.5)
The Black-Scholes price is: 0.08575224964083072
```

### c. Estimate the European call optionâ€™s greeks - delta, gamma, theta, and vega

__Delta__ $\Delta = \frac{\partial C}{\partial S_0} = \frac{BS_{call}(S+\Delta S,K,T,r,\sigma) - BS_{call}( S,K,T,r,\sigma)}{\Delta S}$

__Gamma__ $\Gamma = \frac{\partial^2 C}{\partial S_0^2} = \frac{BS_{call}(S+\Delta S,K,T,r,\sigma) - 2BS_{call}( S,K,T,r,\sigma) + BS_{call}(S-\Delta S,K,T,r,\sigma)}{(\Delta S)^2}$

__Theta__ $\Theta = \frac{\partial C}{\partial T} = \frac{BS_{call}(S ,K,T + \Delta T,r,\sigma) - BS_{call}( S,K,T,r,\sigma)}{\Delta T}$

__Vega__ $\nu = \frac{\partial C}{\partial \sigma} = \frac{BS_{call}(S,K,T,r,\sigma) - BS_{call}( S,K,T,r,\sigma - \Delta \sigma)}{\Delta \sigma}$

__Rho__ $\rho = \frac{\partial C}{\partial r} = \frac{BS_{call}(S,K,T,r + \Delta r,\sigma) - BS_{call}( S,K,T,r,\sigma)}{\Delta r}$

![image-20220420234908186](/Users/elliewu/Library/Application Support/typora-user-images/image-20220420234908186.png)

## 4. Consider the following 2-factor model for stock prices with stochastic volatility:

                                                    Heston Model
$ \begin{equation}
  \left \{
  \begin{aligned}
    &dS_t = rS_td_t + \sqrt{V_t}S_tdW_t^1 &&  \\
    &dV_t = \alpha(\beta-V_t)d_t + \sigma \sqrt{V_t}dW_t^2 && 
  \end{aligned} 
  \right.
\end{equation} $

__Three Truncation Methods__

$\hat S _{k+1} = \hat S_k + r\hat S_k\Delta + \sqrt{f_3(\hat V_k)} \hat S_k\sqrt{\Delta}Z^1_{k+1}  $

$\hat V _{k+1} = f_1(\hat V_k) + \alpha(\beta-f_2(\hat V_k))\Delta + \sigma\sqrt{f_3(\hat V_k)}\sqrt{\Delta}Z^2_{k+1} $

| Scheme             | $f_1$               | $f_2$               | $f_3$               |
| ------------------ | ------------------- | ------------------- | ------------------- |
| Reflection         | $\left| x \right| $ | $\left| x \right| $ | $\left| x \right| $ |
| Partial Truncation | $x$                 | $x$                 | $x^+$               |
| Full Truncation    | $x$                 | $x^+$               | $x^+$               |

**Assume K = 20, T = 0.5 for ğœŒ = âˆ’0.6, ğ‘Ÿ = 0.03, ğ‘† = $48, ğ‘‰ = 0.05, ğœ = 0.42, ğ›¼ = 5.8, ğ›½ = 0.0625.** 

**It seems that three methods get similar answer when T is small as 0.5**

<img src="/Users/elliewu/Library/Application Support/typora-user-images/image-20220421105458309.png" alt="image-20220421105458309" style="zoom:50%;" />



## 5. The objective of this exercise is to compare a sample of Pseudo-Random numbers with a sample of Quasi-Monte Carlo numbers of ğ‘ˆğ‘›ğ‘–ğ‘“ğ‘œğ‘Ÿğ‘š[0,1]ğ‘¥[0,1]:

### (a) - (d)

**For question (a), I apply LGM method to generate 2-dimensional uniform vectors.  From the graph, it seems random variables generated by LGM method is random, but not really evenly distributed. For base 2 and 7, it is very evenly and random distributed. However, the two-dimensional sequences generated with base 2 and 4 is not random and evenly distributed. It has very clear pattern and there are overlapping between numbers. One reason might be because 4 is not a prime number, and numbers with base 2, 4 would have many common factors. **.

![image-20220420235218472](/Users/elliewu/Library/Application Support/typora-user-images/image-20220420235218472.png)



### (e) Use 2-dimensional Halton sequences to compute the following integral:

 $I = \int^{1}_{0} \int^{1}_{0} e^{-xy}(\sin 6\pi x+ \cos ^{\frac{1}{3}}2\pi y)dxdy$ , Use N=10,000 in your simulations. Try different couples for bases: (2,4), (2,7), (5,7).

1. For **base 2,4**, the integral value is **-0.004884**
2. For **base 2,7**, the integral value is **0.026114**
3. For **base 5,7**, the integral value is **0.026164**

<img src="/Users/elliewu/Library/Application Support/typora-user-images/image-20220420235417947.png" alt="image-20220420235417947" style="zoom:50%;" />